
<div class="container-fluid bg-white mh-100 mw-100">

    <div class="d-flex p-2 flex-row">
        <div class="col-xs-12 col-md-6 col-lg-6">
            <h1>Paz y Salvos</h1>
            <br>
        </div>
        <div class="col-xs-12 col-md-6  col-lg-6 align-items-end ">
            <div class="row">
                <div class="col-md-6">
                    <p>Numero total de Registros:   <span><em>321321321</em></span></p>
                </div>
                <div class="col-md-6">
                    <p>Numero total de Registros:   <span><em>25</em></span></p>
                </div>
              </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12 col-md-6 col-lg-4">
            <p><b>Filtrar por:</b></p>
            <select class="form-select" aria-label="Default select example">
                <option selected>Selecciona opcion del menu</option>
                <option value="1">Cienias</option>
                <option value="2">Ingenieria</option>
                <option value="3">Macarena</option>
            </select>
            <div class="input-group mt-2">
                <span class="input-group-text">Codigo Estudiantil</span>
                <input type="text" aria-label="First name" class="form-control">
              </div>
        </div>


        <div class="col-12">
          <button class="btn btn-success" (click)="loadSolicitud()" >Listar informacion</button>

        </div>


        <div class="col-xs-12 col-md-6  col-lg-8 align-items-end ">

            <form action="">
                <!-- <mat-form-field appearance="fill" >
                    <mat-label>Choose a date</mat-label>
                    <input style="display: inline; width: 100px;" class="form-control" matInput [matDatepicker]="datepicker"  [(ngModel)]="fecha_inicio" name="fecha_inicio">
                    <mat-hint>MM/DD/YYYY</mat-hint>
                    <mat-datepicker-toggle  color="yellow" matIconSuffix [for]="datepicker">
                     <mat-icon color="yellow"matDatepickerToggleIcon>
                        calendar_month
                      </mat-icon> 
                    </mat-datepicker-toggle>
                    <mat-datepicker #datepicker>
                      <mat-datepicker-actions>
                        <button mat-button matDatepickerCancel>Cancel</button>
                        <button mat-raised-button color="warn" matDatepickerApply>Apply</button>
                      </mat-datepicker-actions>
                    </mat-datepicker>
                  </mat-form-field> -->
                
            </form>

            <button *ngIf="solicitudesExt.length>0" class="btn back-button btn-block" (click)="solicitudesExt=[]">
              <i class="fa fa-arrow-left mr-1" aria-hidden="true"></i>
              Regresar
          </button>
          <nb-card>
              <nb-card-header>
                  <div class="text-center pt-2">
                      <div class="menu-header">
                          <h1>
                              Listado de solicitudes {{estadoNum!=null ? estados[estadoNum].Nombre : ''}} {{periodo==null ? "todos los periodos" : periodos[periodo]?.Nombre}}
                          </h1>
                      </div>
                      <small>
                          Las solicitudes se cargan de la más reciente a la más antigua.
                      </small>
                  </div>
              </nb-card-header>
              <hr>
              <nb-card-body *ngIf="solicitudesExt.length==0">
                  <div class="contain">
                      <mat-form-field class="periodo">
          
                          <mat-label>Periodo</mat-label>
                          <select matNativeControl [(ngModel)]="periodo">
                              <option *ngFor="let option of periodos;let i = index;" [ngValue]="i">
                                  {{option.Nombre }}</option>
                              <option [ngValue]="null">Todos los periodos</option>
                          </select>
          
                          <br>
                      </mat-form-field>
          
                      <mat-form-field class="estado">
                          <mat-label>Estado Solicitud</mat-label>
                          <select matNativeControl [(ngModel)]="estadoTipo">
                              <option [ngValue]="null" (click)="estadoNum=null;">Todos los estados</option>
                              <option *ngFor="let estadoTipo of estadosTipoSolicitud; let i=index;" [ngValue]="estadoTipo.Id" (click)="estadoNum=i;">
                                  {{estadoTipo.EstadoId.Nombre }}</option>
                          </select>
                      </mat-form-field>
              
                      <mat-form-field class="finalizada">
                          <mat-label>Tipo de Solicitud</mat-label>
                          <select matNativeControl [(ngModel)]="itemTipoSol">
                              <option value="activa">Activa</option>
                              <option value="finalizada"> Finalizada </option>
                              <option value="null">Cualquiera</option>
                          </select>
                      </mat-form-field>
          
                      <button class="btn btn-success" routerLink="./0">
                          <i class="fa fa-plus" aria-hidden="true"></i>
                          Agregar solicitud
                      </button>
                  </div>
                  <p class="line"></p>
                  <button nbButton fullWidth hero shape="semi-round" status="warning" type="submit" class="submit-button" (click)="buscarSolicitudes()">
                      <i class="fa fa-search mr-1" aria-hidden="true"></i>
                      Buscar solicitudes
                  </button>
              </nb-card-body>
          
              <nb-card-body class="fijo" *ngIf="solicitudesExt.length>0">
                  <div class="text-center table-pag">
                      <mat-form-field class="page justify-content-center text-center">
                          <mat-label class="text-center">Tamaño de Tabla</mat-label>
                          <select matNativeControl [(ngModel)]="paginacion">
                              <option *ngFor="let option of itemsPag | slice:0:6" [value]="option" [selected]="paginacion === option">{{
                                  option }}</option>
                          </select>
                      </mat-form-field>
                  </div>
                  <table class="table">
                      <thead class="bg-ud-table">
                          <tr>
                              <th scope="col">#</th>
                              <th scope="col">Tipo solicitud</th>
                              <th scope="col">Estado</th>
                              <th scope="col">Fecha radicacion</th>
                              <th scope="col">nombre</th>
                              <th scope="col">Periodo</th>
                              <th scope="col"></th>
                              <th scope="col">Opciones</th>
                          </tr>
                      </thead>
                      <tbody class="bg-ud-table-cell">
                          <tr *ngFor="let item of solicitudesExt ; let i = index">
                              <!-- (pagina -1)*tamPag :  ((pagina)*tamPag) -->
                              <th scope="row">{{ (i+1) + (pagActual -1)*paginacion }}</th>
                              <td>{{ item.Solicitud.EstadoTipoSolicitudId.TipoSolicitud.Nombre }}</td>
                              <td>{{ item.Solicitud.EstadoTipoSolicitudId.EstadoId.Nombre }}</td>
                              <td>{{ item.Solicitud.FechaRadicacion | fechaFormat }}</td>
                              <td>{{ item.NombreCompleto }}</td>
                              <td>{{ item.Periodo }}</td>
                              <td>
                                  <span *ngIf="item.Solicitud.SolicitudFinalizada" class="badge rounded-pill bg-danger">Finalizada</span>
                                  <span *ngIf="!item.Solicitud.SolicitudFinalizada" class="badge rounded-pill bg-success">Activa</span>
                              </td>
                              <!-- | date: 'dd/MM/yyyy' -->
                              <td>
                                  <button class="btn init-icon " routerLink="./{{item.Solicitud.Id}}" title="Ver solicitante">
                                      <i class="fa fa-user" aria-hidden="true"></i>
                                      Evaluar solicitud
                                  </button>
          
                              </td>
                          </tr>
                      </tbody>
                  </table>
                  <div class="center-block">
                      <!-- <pagination-controls class="pag" responsive="true" autoHide="true" previousLabel="Anterior" nextLabel="Siguiente" (pageChange)="pagActual = $event">
                      </pagination-controls> -->
                  </div>
                  <div class="download">
                      <button (click)="exportarCsv()" class="btn btn-primary btn-block">
                          <i class="fa fa-download mr-1"></i>
                          Descargar solicitudes
                      </button>
                  </div>
              </nb-card-body>
          
          </nb-card>
          
          
          <nb-card *ngIf="periodos==[]">
              <div class="alert alert-warning text-center mt-3">
                  <h3 class="alert-heading">No hay ningun periodo para consultar</h3>
                  <p>
                      <i class="fa fa-exclamation fa-2x    "></i>
                  </p>
              </div>
          </nb-card>

        </div>
    </div>

    <hr>

    <div class="row">
        <div class="col-12">
            <ngx-tabla-pazysalvos [solicitudesExt]="solicitudesExt"></ngx-tabla-pazysalvos>
        </div>

    </div>

</div>



<!-- <div class="container">
    <h1>Rango de fechas con datepicker</h1>
  
    <div class="row">
      <div class="col">
        <div class="input-group">
          <span class="input-group-text">Fecha de inicio:</span>
          <input
            class="form-control"
            placeholder="dd/mm/yyyy"
            name="fecha_inicio"
            [(ngModel)]="fecha_inicio"
            ngbDatepicker
            #dp_inicio="ngbDatepicker"
          />
          <button class="btn btn-outline-secondary" (click)="dp_inicio.toggle()">
            <i class="bi bi-calendar"></i>
          </button>
        </div>
      </div>
      <div class="col">
        <div class="input-group">
          <span class="input-group-text">Fecha de fin:</span>
          <input
            class="form-control"
            placeholder="dd/mm/yyyy"
            name="fecha_fin"
            [(ngModel)]="fecha_fin"
            ngbDatepicker
            #dp_fin="ngbDatepicker"
          />
          <button class="btn btn-outline-secondary" (click)="dp_fin.toggle()">
            <i class="bi bi-calendar"></i>
          </button>
        </div>
      </div>
    </div>
  
    <div class="mt-3">
      Fecha de inicio seleccionada: {{ fecha_inicio | date }}
    </div>
    <div>
      Fecha de fin seleccionada: {{ fecha_fin | date }}
    </div>
  </div> -->
  


